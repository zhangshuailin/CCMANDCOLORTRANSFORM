import numpy as np
import matplotlib.pyplot as plt
import math
# 使用 scipy.optimize.curve_fit 进行拟合
from scipy.optimize import curve_fit

#srcPosex=np.array([2065.07,2063.68,2062.71,2061.35,2060.22,2058.52,2057.13,2055.51,2053.55,2051.66,2049.51,2047.27,2044.75,2041.86,2124.48,2125.15,2125.84,2126.76,2127.64,2128.64,2130.14,2131.93,2134.04,2136.14,2138.14,2140.19,2141.92,2188.43,2190.84,2193.63,2196.69,2200.33,2204.40,2209.39,2214.99,2221.27,2228.39,2235.69,2242.81,2249.60,2256.97,2261.76,2267.06,2272.71,2279.08,2286.83,2295.78,2305.70,2317.37,2330.02,2343.31,2356.59,2369.33,2332.17,2339.22,2347.05,2355.73,2365.90,2377.52,2390.89,2406.26,2423.87,2443.16,2463.43,2483.76,2503.86,2414.22,2424.45,2435.36,2447.73,2461.88,2478.19,2497.01,2518.75,2543.35,2570.59,2598.80,2627.49,2655.98,2505.47,2518.78,2533.57,2550.25,2569.32,2591.23,2616.59,2645.55,2678.06,2714.12,2751.56,2789.64,2828.29,2606.00,2623.75,2643.28,2665.41,2690.42,2719.09,2751.93,2789.31,2831.48,2877.13,2925.05,2974.18,3024.12,2717.85,2741.02,2766.66,2795.13,2827.21,2863.82,2905.65,2952.82,3004.96,3061.53,3121.89,3184.11,3245.73,2841.13,2870.54,2903.71,2939.91,2981.13,3027.13,3079.42,3137.46,3201.50,3270.89,3345.50,3420.93,3493.42,2974.76,3012.68,3054.31,3100.34,3151.45,3209.02,3272.64,3343.68,3422.05,3506.67,3596.45,3684.12,3764.85,3119.54,3166.20,3218.14,3275.23,3338.38,3408.44,3486.54,3573.05,3667.79,3768.98,3870.74,3969.28,4053.96,3274.79,3331.82,3395.54,3464.59,3541.76,3627.53,3721.62,3824.30,3441.06,3509.77,3759.80,3860.33,3613.91,3694.36,3984.81,3789.48,3881.48,147.416,65.0810,299.142,222.575,141.257,54.7397,450.969,381.218,306.892,226.924,142.125,52.5301,600.383,538.237,470.963,398.776,321.474,238.982,151.822,60.5550,744.910,689.821,631.032,566.628,497.772,423.284,343.827,259.867,172.905,84.2645,882.988,835.058,783.278,727.179,666.450,601.035,530.092,454.303,374.547,292.182,209.270,128.577,53.5560,1014.41,973.117,928.278,879.426,826.504,769.149,707.046,640.388,569.236,493.998,417.432,341.707,269.599,204.838,1139.42,1104.11,1065.50,1023.64,977.759,927.427,873.153,814.844,752.358,686.116,617.006,547.496,480.379,417.851,1257.09,1227.08,1194.39,1158.39,1119.09,1075.64,1028.27,977.286,922.691,865.315,804.744,742.381,681.057,1366.53,1341.46,1314.06,1283.86,1250.27,1213.28,1172.40,1127.99,1080.87,1030.98,978.890,925.089,870.322,1467.86,1447.04,1424.32,1398.91,1370.85,1339.69,1305.26,1267.50,1226.80,1184.16,1139.75,1093.89,1046.84,1561.46,1544.32,1525.53,1504.54,1481.48,1455.63,1426.87,1395.51,1361.29,1325.11,1287.62,1249.11,1209.85,1647.91,1633.86,1618.60,1601.52,1582.69,1561.73,1538.26,1512.45,1484.45,1454.58,1423.65,1392.04,1359.72,1327.10,1727.85,1716.66,1704.21,1690.64,1675.68,1658.91,1640.31,1619.88,1597.29,1573.31,1548.47,1522.99,1497.35,1471.29,1802.13,1793.01,1783.83,1773.08,1761.54,1748.66,1734.14,1718.32,1701.16,1682.55,1663.24,1643.58,1623.68,1603.59,207.172,192.772,377.861,356.094,338.006,564.395,533.318,507.230,485.547,764.113,723.729,688.573,658.693,632.594,925.918,881.055,842.232,807.820,777.381,1138.22,1082.83,1034.44,990.528,951.874,916.581,1291.73,1232.62,1179.63,1132.38,1088.86,1049.89,1506.45,1436.08,1373.02,1316.68,1265.25,1218.85,1175.87,1725.75,1643.54,1569.96,1504.28,1444.67,1390.62,1341.08,1295.67,1949.16,1854.53,1769.55,1694.04,1625.68,1564.08,1507.27,1455.67,1407.66,2176.49,2068.91,1972.34,1885.82,1807.88,1737.96,1674.15,1615.78,1561.99,1512.17,2407.76,2287.15,2178.15,2080.18,1991.63,1912.38,1840.69,1775.41,1715.47,1660.18,1608.63,2641.64,2508.56,2387.40,2277.43,2178.25,2088.67,2007.93,1935.00,1868.36,1807.12,1750.59,1697.98,2478.86,2268.06,2177.51,2095.61,2021.51,1953.81,1891.59,1834.00,1780.45,3111.61,2959.16,2816.01,2684.07,2562.65,2451.70,2350.78,2259.27,2176.59,2101.61,2032.96,1969.82,1911.42,1856.98,3032.87,2891.64,2760.80,2639.61,2528.69,2427.35,2335.46,2251.93,2175.97,2106.48,2042.63,1983.72,1928.41])
#srcPosey=np.array([1564.19,1491.93,1414.62,1332.54,1244.19,1148.70,1044.62,930.927,805.632,668.901,520.304,361.142,191.971,12.8367,1602.53,1528.46,1449.67,1365.97,1275.64,1177.92,1071.25,954.077,824.741,682.669,527.669,360.563,182.941,1643.45,1568.00,1487.48,1401.78,1309.29,1209.11,1099.41,978.653,844.890,697.131,535.022,360.411,173.101,1688.07,1610.77,1528.59,1440.54,1345.58,1242.52,1129.77,1005.04,866.187,712.313,543.097,359.563,162.637,1736.53,1657.27,1572.95,1482.51,1384.98,1278.95,1162.27,1033.08,888.919,728.437,551.460,358.629,150.776,1789.75,1708.27,1621.59,1528.47,1428.08,1318.36,1197.61,1063.43,913.305,745.829,560.423,357.975,138.350,1848.51,1764.89,1675.63,1579.51,1475.59,1361.88,1236.44,1096.57,940.227,764.870,570.546,357.958,126.026,1913.72,1827.67,1735.51,1636.46,1528.70,1410.53,1279.81,1133.95,970.329,786.971,583.359,359.270,114.609,1985.50,1897.75,1802.97,1700.65,1588.61,1465.55,1329.35,1176.82,1005.26,813.709,599.864,363.307,106.362,2065.30,1975.13,1878.03,1772.44,1656.58,1528.64,1386.16,1226.81,1047.57,846.486,621.188,372.814,104.912,2151.04,2060.53,1961.43,1852.61,1733.19,1600.47,1452.13,1285.99,1098.23,887.075,650.947,391.849,114.500,2244.11,2152.52,2052.28,1941.20,1818.63,1681.71,1528.17,1354.65,1158.59,938.199,693.144,424.608,142.254,2343.32,2251.88,2150.64,2038.46,1913.43,1773.11,1614.23,1434.58,2449.23,2357.90,2017.25,1873.38,2559.29,2469.62,2127.65,2672.17,2583.32,2339.20,2250.88,2266.33,2178.10,2081.92,1976.22,2193.41,2105.76,2009.80,1905.00,1789.55,1663.78,2122.22,2034.82,1939.63,1835.79,1722.22,1597.58,1461.06,1311.75,2053.51,1966.94,1872.55,1770.24,1657.99,1535.75,1401.57,1254.50,1093.81,919.551,1988.50,1902.65,1809.48,1708.61,1598.53,1478.40,1347.23,1203.02,1045.35,873.792,688.964,492.027,284.989,1926.68,1841.70,1750.26,1651.04,1543.57,1425.88,1297.69,1157.03,1003.10,835.346,653.307,458.626,253.351,41.7522,1868.05,1784.55,1694.84,1597.94,1492.86,1378.13,1253.04,1115.97,966.187,802.846,624.879,433.576,230.980,20.8164,1813.06,1731.31,1643.53,1548.99,1446.51,1335.03,1213.14,1079.72,933.908,775.111,602.233,415.229,216.340,1761.95,1681.88,1596.12,1504.06,1404.37,1296.00,1177.55,1047.73,906.073,751.560,583.763,402.266,207.954,1714.82,1636.27,1552.81,1463.04,1366.02,1260.65,1145.59,1019.66,881.692,731.252,568.399,392.335,203.727,1671.26,1594.68,1512.96,1425.45,1331.04,1228.62,1116.71,994.227,860.024,713.573,555.313,384.793,202.168,1630.90,1555.89,1476.11,1390.62,1298.60,1198.80,1090.06,970.738,840.241,697.844,544.025,378.962,202.354,14.9176,1593.40,1520.08,1441.66,1358.11,1268.16,1170.95,1064.93,948.874,821.903,683.524,533.975,373.968,203.346,22.5487,1558.31,1486.08,1409.65,1327.71,1239.75,1144.53,1040.87,927.891,804.293,669.728,524.723,369.632,204.798,30.2502,2935.06,2811.99,2980.21,2851.43,2731.58,3023.36,2888.34,2763.23,2648.83,3062.49,2922.45,2792.50,2673.96,2565.24,2953.17,2819.07,2696.22,2583.75,2481.59,2980.20,2841.84,2715.88,2600.53,2495.83,2400.08,2862.25,2733.22,2615.70,2508.64,2411.04,2322.01,2881.21,2749.26,2629.40,2520.25,2420.60,2329.90,2247.28,2898.60,2764.12,2641.71,2530.37,2428.89,2336.40,2252.32,2175.59,2915.85,2778.89,2654.08,2540.22,2436.62,2342.43,2256.69,2178.79,2107.73,2932.57,2794.29,2667.06,2550.78,2444.92,2348.81,2261.65,2182.10,2110.11,2044.31,2948.80,2809.63,2681.43,2562.86,2454.75,2356.30,2267.44,2186.60,2113.27,2046.40,1985.37,2963.38,2825.01,2696.19,2576.82,2466.59,2366.06,2275.09,2192.44,2117.77,2049.52,1987.68,1930.91,2591.62,2378.14,2284.91,2200.52,2124.00,2054.55,1991.37,1933.44,1880.65,2981.75,2849.83,2724.05,2605.96,2495.25,2392.22,2297.40,2210.70,2132.31,2061.33,1996.91,1937.63,1883.89,1834.09,2734.55,2618.25,2509.12,2406.55,2311.46,2223.04,2142.97,2069.84,2003.86,1943.74,1888.39,1837.83,1791.13])
#dstPosex=np.array([2065.06,2063.67,2062.68,2061.25,2060.03,2058.24,2056.74,2055.04,2053.05,2051.16,2049.09,2046.97,2044.62,2041.94,2124.30,2125.06,2125.69,2126.37,2126.83,2127.20,2127.89,2128.72,2129.79,2130.86,2131.95,2133.32,2134.72,2187.60,2190.27,2193.07,2195.82,2198.76,2201.70,2205.16,2208.86,2212.99,2217.87,2223.10,2228.63,2234.57,2254.62,2259.90,2265.36,2270.70,2276.19,2282.36,2289.06,2296.10,2304.39,2313.49,2323.46,2334.18,2345.65,2326.97,2334.75,2342.91,2351.34,2360.49,2370.15,2380.59,2392.06,2405.04,2419.39,2435.08,2451.98,2470.65,2404.40,2415.51,2426.87,2439.01,2452.01,2466.01,2481.22,2498.09,2516.83,2537.80,2560.33,2585.03,2612.54,2488.82,2503.00,2518.21,2534.57,2552.27,2571.46,2592.56,2615.74,2641.33,2670.07,2701.15,2735.40,2774.63,2580.13,2598.46,2618.11,2639.57,2662.82,2688.26,2716.19,2747.03,2781.48,2819.34,2861.05,2907.75,2961.92,2680.36,2703.47,2728.59,2755.76,2785.44,2818.19,2854.47,2894.60,2938.88,2988.11,3043.81,3107.20,3180.33,2790.16,2818.60,2850.25,2884.23,2922.14,2963.57,3009.86,3060.88,3117.82,3181.84,3255.78,3339.96,3437.37,2909.70,2945.39,2984.35,3027.04,3073.98,3126.39,3184.11,3249.08,3322.66,3406.47,3503.93,3614.67,3744.61,3041.33,3084.66,3132.82,3185.68,3244.15,3309.22,3382.55,3465.76,3561.07,3670.97,3796.28,3944.62,4123.42,3186.86,3239.83,3299.27,3364.04,3437.14,3519.71,3612.73,3718.75,3350.30,3415.28,3658.62,3761.30,3532.41,3611.61,3912.27,3736.55,3833.38,211.422,121.002,387.775,308.927,222.834,127.874,550.317,481.753,407.330,325.187,235.109,135.473,700.482,641.347,576.580,505.942,428.537,343.220,248.912,143.755,838.987,787.601,732.492,671.589,605.575,532.613,452.259,363.318,264.882,154.712,966.807,922.537,874.750,822.899,766.456,704.936,636.812,561.565,478.308,385.833,282.571,166.036,31.6132,1085.65,1047.55,1006.46,961.940,913.815,861.501,804.222,741.345,671.666,593.679,507.386,411.239,302.687,177.659,1197.16,1164.41,1129.05,1091.18,1050.07,1005.23,956.764,904.013,845.911,781.459,709.478,629.600,540.848,440.121,1301.67,1273.55,1243.47,1210.99,1176.15,1138.13,1096.93,1052.38,1003.76,950.784,891.551,825.290,751.968,1399.22,1375.43,1350.04,1322.78,1293.20,1261.30,1226.51,1188.82,1148.37,1104.28,1055.90,1002.16,941.669,1490.50,1470.47,1449.26,1426.30,1401.73,1375.19,1346.44,1315.16,1281.25,1244.93,1205.41,1161.85,1112.94,1576.11,1559.45,1541.82,1522.84,1502.77,1481.00,1457.34,1431.91,1404.09,1374.14,1341.90,1306.77,1267.86,1656.63,1642.89,1628.53,1613.13,1596.84,1579.38,1560.33,1539.72,1517.41,1493.22,1467.32,1439.36,1408.52,1374.12,1732.52,1721.54,1709.85,1697.67,1684.83,1670.97,1656.05,1639.96,1622.16,1603.03,1582.61,1560.58,1536.80,1510.29,1804.28,1795.36,1786.79,1777.19,1767.36,1756.80,1745.21,1732.82,1719.43,1704.69,1688.97,1672.24,1654.15,1634.26,194.737,202.305,398.480,394.159,389.809,605.958,589.006,574.030,561.028,816.009,787.381,761.487,738.820,718.393,989.403,952.557,920.028,890.594,864.103,1195.13,1147.01,1104.35,1065.05,1030.10,997.903,1344.37,1290.78,1242.25,1198.63,1158.21,1121.90,1544.91,1480.19,1421.69,1369.04,1320.74,1277.04,1236.57,1748.70,1672.58,1603.94,1542.19,1485.80,1434.49,1387.41,1344.34,1955.96,1868.19,1788.93,1717.92,1653.12,1594.34,1539.98,1490.59,1444.78,2166.83,2067.03,1977.32,1896.38,1822.77,1756.12,1694.86,1638.62,1586.81,1538.96,2381.68,2269.39,2168.56,2077.68,1994.84,1919.87,1851.32,1788.38,1730.31,1676.68,1626.84,2600.12,2474.76,2362.62,2261.35,2169.67,2086.05,2009.73,1939.93,1875.50,1815.89,1760.74,1709.50,2448.06,2254.61,2170.42,2093.21,2022.35,1956.83,1896.10,1839.63,1787.11,3050.41,2897.24,2760.22,2637.67,2526.65,2425.64,2333.33,2248.70,2171.09,2099.61,2033.24,1971.54,1914.08,1860.40,2964.33,2830.04,2709.19,2598.98,2498.58,2406.45,2321.96,2244.01,2171.94,2104.96,2042.63,1984.61,1929.86])
#dstPosey=np.array([1564.17,1491.94,1414.80,1333.51,1247.16,1155.48,1057.59,952.869,839.547,717.416,585.214,442.678,288.333,119.561,1602.34,1528.45,1449.79,1366.66,1277.97,1183.63,1082.76,974.359,857.038,729.945,591.976,442.266,279.978,1642.73,1567.80,1487.58,1402.43,1311.36,1214.24,1110.02,997.828,876.096,743.642,599.146,442.467,270.819,1686.19,1609.98,1528.50,1441.21,1347.68,1247.53,1140.05,1023.73,896.956,758.654,607.456,442.265,260.898,1732.58,1655.15,1572.18,1482.99,1387.19,1284.19,1172.77,1051.98,919.959,775.260,616.551,442.126,249.215,1782.53,1703.78,1619.32,1528.22,1430.17,1323.92,1208.70,1083.11,945.292,793.741,626.619,442.147,236.027,1836.57,1756.66,1670.65,1577.57,1476.93,1367.46,1248.18,1117.35,973.565,814.220,637.861,442.146,221.047,1895.47,1814.13,1726.34,1631.49,1528.19,1415.37,1291.75,1155.63,1004.97,837.533,651.079,441.849,203.490,1959.46,1877.26,1787.91,1691.03,1584.79,1468.40,1340.47,1198.57,1040.40,864.382,666.218,441.042,183.048,2030.27,1946.36,1855.59,1756.57,1647.79,1527.87,1394.92,1247.09,1081.46,895.094,682.874,440.035,159.466,2106.75,2022.80,1930.66,1829.33,1718.06,1594.54,1456.78,1302.77,1128.39,930.180,702.510,439.447,130.988,2191.27,2106.37,2013.40,1910.35,1796.66,1669.72,1527.35,1366.02,1182.12,971.052,726.696,438.587,94.7770,2284.31,2199.41,2105.52,2001.56,1885.74,1755.67,1607.91,1439.45,2388.70,2303.71,1987.75,1853.94,2505.21,2421.87,2104.83,2637.15,2555.42,2311.43,2230.12,2228.23,2146.73,2057.68,1959.32,2151.18,2070.12,1981.27,1883.99,1776.21,1657.65,2080.20,1999.32,1911.22,1814.99,1709.44,1592.91,1463.92,1320.35,2014.61,1934.41,1846.98,1752.22,1648.13,1534.47,1408.92,1269.71,1114.61,941.030,1954.41,1874.70,1788.22,1694.65,1592.59,1481.16,1359.18,1224.20,1074.67,908.183,722.053,512.078,271.403,1898.29,1819.09,1733.88,1641.52,1541.64,1432.46,1313.62,1182.92,1038.80,879.195,701.086,501.871,276.923,19.9428,1845.60,1767.35,1683.26,1592.56,1494.48,1387.80,1271.89,1145.07,1006.09,853.009,682.715,493.042,280.735,41.3153,1796.25,1719.08,1636.19,1547.07,1450.84,1346.77,1233.68,1110.51,976.087,828.934,666.344,485.446,284.046,1750.10,1673.88,1592.20,1504.71,1410.45,1308.77,1198.63,1078.91,948.916,806.979,651.288,479.108,287.582,1707.03,1631.57,1551.35,1465.32,1372.95,1273.58,1166.31,1050.21,924.059,786.824,637.338,472.848,290.858,1666.55,1592.31,1513.08,1428.55,1338.08,1241.06,1136.50,1023.60,901.255,768.425,624.406,467.007,293.701,1628.38,1555.02,1477.06,1393.93,1305.31,1210.46,1108.71,998.810,880.154,751.612,612.599,461.677,296.233,113.560,1592.27,1520.03,1442.91,1361.27,1274.35,1181.81,1082.60,975.825,860.675,736.247,601.824,456.583,298.307,124.497,1557.94,1486.37,1410.88,1330.58,1245.48,1154.83,1057.92,954.185,842.369,721.760,591.954,451.925,300.121,134.020,2944.67,2805.32,2962.09,2821.31,2694.67,2981.01,2837.74,2709.02,2593.96,2999.77,2854.63,2723.82,2606.98,2501.45,2871.54,2738.93,2619.81,2512.24,2415.48,2888.15,2753.26,2632.76,2523.78,2425.63,2336.31,2767.99,2645.91,2536.00,2436.48,2346.04,2263.62,2783.39,2659.69,2548.58,2447.90,2356.12,2272.48,2196.14,2798.62,2673.44,2560.91,2459.04,2366.18,2281.29,2203.76,2132.67,2814.43,2687.39,2573.46,2470.18,2376.15,2290.26,2211.52,2139.43,2073.20,2830.20,2701.66,2585.99,2481.32,2386.14,2299.29,2219.81,2146.52,2079.49,2017.68,2846.42,2715.61,2598.81,2492.56,2396.19,2308.17,2227.98,2154.14,2086.25,2023.56,1965.72,2863.05,2730.04,2611.32,2504.12,2406.35,2317.32,2236.21,2161.63,2093.22,2029.72,1971.33,1917.08,2515.67,2326.67,2244.40,2169.26,2100.13,2036.32,1977.25,1922.22,1871.41,2897.85,2759.74,2636.92,2527.12,2427.46,2336.41,2253.16,2176.78,2106.96,2042.74,1983.39,1927.75,1876.46,1828.26,2650.23,2538.30,2437.77,2345.96,2262.19,2184.63,2114.08,2048.87,1989.07,1933.54,1881.44,1833.02,1787.65])

centerx = 2043
centery = 1517
max_dis = 2560
dx = (dstPosex-centerx)/max_dis
dy = (dstPosey-centery)/max_dis
r = np.sqrt(np.power(dx,2)+np.power(dy,2))
t = np.arctan(r)


dxrad = (srcPosex-centerx)/max_dis
dyrad = (srcPosey-centery)/max_dis
ratiox = dxrad/dx
ratioy = dyrad/dy
#print(ratiox)
#print(ratioy)
ratio = (ratiox+ratioy)/2
rwap = ratio*r
print(rwap)
# 这里我们创建一个多项式拟合函数
def poly_fit(x, *coeffs):
    # 计算多项式的值
    return coeffs[0] * x + coeffs[1] * x**3 + coeffs[2] * x**5 + coeffs[3] * x**7


# 初始猜测系数，可以设置为 0
initial_guess = [1, 1, 1, 1] 



# 执行拟合
coefficients, covariance = curve_fit(poly_fit, t, rwap, p0=initial_guess)

# 打印拟合得到的系数
print("Fitted coefficients:", coefficients)

# 计算拟合数据
warp_t_fit = poly_fit(t, *coefficients)

# 绘制结果
#plt.scatter(t, rwap,     color='red',   label='Noisy data points', alpha=0.5)
plt.plot(t,    rwap,     color='green', label='True function',     linewidth=1)
#plt.plot(t,    warp_t_fit, color='blue',  label='Fitted polynomial', linewidth=1)
plt.xlabel('t')
plt.ylabel('y')
plt.legend()
plt.grid()
plt.show()








































